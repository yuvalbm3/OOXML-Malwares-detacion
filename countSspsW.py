import os

x = ""
susword = ['0x', 'base64 strings', 'auroopen', 'shell', 'chr', 'run', 'showwindow', 'document_open',
           'creatobject', 'chrw', 'vba_stomping', 'call', 'chrb', 'vbhide', 'wscript.shell', 'strreverse', 'xor',
           'dridex_strings', 'open', 'system']


def findXML(path):
    global x
    try:
        fol = os.listdir(path)
        for i in fol:
            if i.endswith("xml"):
                try:
                    f = open(f'{path}/{i}', 'r', encoding='utf-8')
                    x=x+f.read()
                except:
                    print(f'!!{path}/{i}')
            elif len(i) > 2:
                findXML(f'{path}/{i}')
    except:
        print(path)
    return x


path = 'C:/Users/Ben/Desktop/docxfile/hrazdan.am_upload_legislation__d5_ad_d5_b8_d6_80_d5_b0_d6_80_d5_a4._20_d5_b4_d5_a1_d6_80_d5_b4_d5_ab_d5_b6'
# os.listdir(path)
y = findXML(path)
i = 0
for x in susword:
    i = i + y.count(x)
print(i)
